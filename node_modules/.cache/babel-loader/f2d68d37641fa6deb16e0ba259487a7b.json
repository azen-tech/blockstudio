{"ast":null,"code":"import _regeneratorRuntime from\"/home/azen/Documents/blockstudio-main/App/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/azen/Documents/blockstudio-main/App/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"/home/azen/Documents/blockstudio-main/App/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/home/azen/Documents/blockstudio-main/App/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/home/azen/Documents/blockstudio-main/App/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/home/azen/Documents/blockstudio-main/App/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import Web3 from'web3';import React from\"react\";import{COLORS}from\"./Colors\";import SongCard from\"./SongCard\";import Loader from\"react-loader-spinner\";import{FontAwesomeIcon}from'@fortawesome/react-fontawesome';import{faHeadphones,faStore,faUser,faGift}from'@fortawesome/free-solid-svg-icons';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Audience=/*#__PURE__*/function(_React$Component){_inherits(Audience,_React$Component);var _super=_createSuper(Audience);function Audience(props){var _this;_classCallCheck(this,Audience);_this=_super.call(this,props);_this.onSubmitClick=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(event){var contractInstance;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:event.preventDefault();if(!_this.state.supportArtistUsername){_context.next=7;break;}_context.next=4;return _this.props.contract.deployed();case 4:contractInstance=_context.sent;_context.next=7;return contractInstance.donateArtist(_this.state.supportArtistUsername,{from:_this.props.account,value:_this.web3.utils.toWei(_this.state.donation,'milliether')}).then(function(){window.location.reload();});case 7:console.log(\"Submitted\");case 8:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}();_this.web3=new Web3(Web3.givenProvider||\"http://localhost:7545\");_this.state={name:\"\",audienceID:\"\",store:[],library:[],songsMapping:{},supportArtistUsername:\"\",donation:\"\"};return _this;}_createClass(Audience,[{key:\"componentDidMount\",value:function componentDidMount(){var _this2=this;this.loadStore().then(function(){console.log(\"Loaded Store\");_this2.loadAudienceDetails().then(function(){console.log(\"Loaded Audience's Details\");_this2.loadSongDetails().then(function(){console.log(\"Loaded Songs\");});});});}},{key:\"loadStore\",value:function(){var _loadStore=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var contractInstance,count,mapping,i;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return this.props.contract.deployed();case 2:contractInstance=_context2.sent;_context2.next=5;return contractInstance.getNumSongs({from:this.props.account});case 5:count=_context2.sent;mapping={};for(i=1;i<parseInt(count.toString())+1;i++){mapping[i]=0;}this.setState({songsMapping:mapping});case 9:case\"end\":return _context2.stop();}}},_callee2,this);}));function loadStore(){return _loadStore.apply(this,arguments);}return loadStore;}()},{key:\"loadAudienceDetails\",value:function(){var _loadAudienceDetails=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(){var contractInstance,audienceDetails,mapping,i;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.next=2;return this.props.contract.deployed();case 2:contractInstance=_context3.sent;_context3.next=5;return contractInstance.getAudienceDetails({from:this.props.account});case 5:audienceDetails=_context3.sent;mapping=this.state.songsMapping;for(i=0;i<audienceDetails[2].length;i++){mapping[parseInt(audienceDetails[2][i].toString())]=1;}this.setState({name:audienceDetails[0].toString(),audienceID:audienceDetails[1].toString(),songsMapping:mapping});case 9:case\"end\":return _context3.stop();}}},_callee3,this);}));function loadAudienceDetails(){return _loadAudienceDetails.apply(this,arguments);}return loadAudienceDetails;}()},{key:\"loadSongDetails\",value:function(){var _loadSongDetails=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(){var contractInstance,n,newSongs,purchasedSongs,i,songDetails;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.next=2;return this.props.contract.deployed();case 2:contractInstance=_context4.sent;n=Object.keys(this.state.songsMapping).length;newSongs=[];purchasedSongs=[];i=1;case 7:if(!(i<n+1)){_context4.next=15;break;}_context4.next=10;return contractInstance.getSongDetails(i,{from:this.props.account});case 10:songDetails=_context4.sent;if(this.state.songsMapping[i]===1){purchasedSongs.push({'name':songDetails[0],'artist':songDetails[1],'genre':songDetails[2],'hash':songDetails[3],'cost':songDetails[4].toString(),'songID':i});}else{newSongs.push({'name':songDetails[0],'artist':songDetails[1],'genre':songDetails[2],'hash':songDetails[3],'cost':songDetails[4].toString(),'songID':i});}case 12:i++;_context4.next=7;break;case 15:this.setState({library:purchasedSongs,store:newSongs});case 16:case\"end\":return _context4.stop();}}},_callee4,this);}));function loadSongDetails(){return _loadSongDetails.apply(this,arguments);}return loadSongDetails;}()},{key:\"render\",value:function render(){var _this3=this;if(this.state.ID===\"\"){return/*#__PURE__*/_jsx(\"div\",{style:styles.main,children:/*#__PURE__*/_jsx(Loader,{type:\"Bars\",color:COLORS.black})});}else{return/*#__PURE__*/_jsxs(\"div\",{style:styles.main,children:[/*#__PURE__*/_jsxs(\"div\",{style:styles.info,children:[/*#__PURE__*/_jsxs(\"h2\",{children:[/*#__PURE__*/_jsx(FontAwesomeIcon,{icon:faHeadphones}),\" \",this.state.name,\"  \"]}),/*#__PURE__*/_jsxs(\"h3\",{children:[\" Audience ID : \",this.state.audienceID,\" \"]})]}),/*#__PURE__*/_jsxs(\"div\",{style:styles.area,children:[/*#__PURE__*/_jsxs(\"div\",{style:styles.library,children:[/*#__PURE__*/_jsxs(\"h3\",{style:{textAlign:\"center\"},children:[\" \",/*#__PURE__*/_jsx(FontAwesomeIcon,{icon:faUser}),\" Library \"]}),this.state.library.map(function(item,i){return/*#__PURE__*/_jsx(SongCard,{type:\"audience\",name:item.name,artist:item.artist,genre:item.genre,hash:item.hash,songID:item.songID},i);})]}),/*#__PURE__*/_jsxs(\"div\",{style:styles.store,children:[/*#__PURE__*/_jsxs(\"h3\",{style:{textAlign:\"center\"},children:[\" \",/*#__PURE__*/_jsx(FontAwesomeIcon,{icon:faStore}),\" Store \"]}),this.state.store.map(function(item,i){return/*#__PURE__*/_jsx(SongCard,{contract:_this3.props.contract,ipfs:_this3.props.ipfs,account:_this3.props.account,type:\"shop\",name:item.name,artist:item.artist,genre:item.genre,cost:item.cost,hash:item.hash,songID:item.songID},i);})]})]}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"form\",{children:/*#__PURE__*/_jsxs(\"div\",{style:styles.form,children:[/*#__PURE__*/_jsxs(\"h3\",{style:{textAlign:\"center\"},children:[\" \",/*#__PURE__*/_jsx(FontAwesomeIcon,{icon:faGift}),\" Sponsor Artist\"]}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Artist Username\",style:styles.textInput,value:this.state.supportArtistUsername,required:true,onChange:function onChange(x){_this3.setState({supportArtistUsername:x.target.value});}}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Amount\",style:styles.textInput,value:this.state.donation,required:true,onChange:function onChange(x){_this3.setState({donation:x.target.value});}}),/*#__PURE__*/_jsx(\"input\",{type:\"submit\",onClick:this.onSubmitClick,style:styles.button,value:\"Donate\"})]})})})]});}}}]);return Audience;}(React.Component);var styles={main:{padding:\"3%\",display:\"flex\",flexDirection:\"column\",justifyContent:\"centre\",alignItems:\"center\",height:\"110vh\",gap:\"5%\",background:COLORS.brown},info:{display:\"flex\",flexDirection:\"column\",alignItems:\"center\"},library:{height:\"100%\",width:\"40%\",padding:\"25px\",display:\"flex\",flexDirection:\"column\",borderRadius:\"30px\",border:\"3px solid\",overflow:\"auto\",gap:\"10px\",boxShadow:\"2px 5px 2px #191919\",borderColor:COLORS.black,backgroundColor:COLORS.white},store:{height:\"100%\",width:\"60%\",padding:\"25px\",display:\"flex\",flexDirection:\"column\",borderRadius:\"30px\",border:\"3px solid\",overflow:\"auto\",gap:\"10px\",boxShadow:\"2px 5px 2px #191919\",borderColor:COLORS.black,backgroundColor:COLORS.white},area:{height:\"100%\",width:\"90%\",display:\"flex\",flexDirection:\"row\",gap:\"5%\"},form:{padding:\"2%\",display:\"flex\",flexDirection:\"row\",alignItems:\"center\",borderRadius:\"10px\",border:\"2px solid\",gap:\"3%\",borderColor:COLORS.black,backgroundColor:COLORS.brown},textInput:{width:\"50%\",borderRadius:\"15px\",padding:\"2%\"},button:{padding:\"2%\",borderRadius:\"15px\",border:\"0px\",cursor:\"pointer\",background:COLORS.black,color:COLORS.white}};export default Audience;","map":{"version":3,"sources":["/home/azen/Documents/blockstudio-main/App/src/Components/Audience.js"],"names":["Web3","React","COLORS","SongCard","Loader","FontAwesomeIcon","faHeadphones","faStore","faUser","faGift","Audience","props","onSubmitClick","event","preventDefault","state","supportArtistUsername","contract","deployed","contractInstance","donateArtist","from","account","value","web3","utils","toWei","donation","then","window","location","reload","console","log","givenProvider","name","audienceID","store","library","songsMapping","loadStore","loadAudienceDetails","loadSongDetails","getNumSongs","count","mapping","i","parseInt","toString","setState","getAudienceDetails","audienceDetails","length","n","Object","keys","newSongs","purchasedSongs","getSongDetails","songDetails","push","ID","styles","main","black","info","area","textAlign","map","item","artist","genre","hash","songID","ipfs","cost","form","textInput","x","target","button","Component","padding","display","flexDirection","justifyContent","alignItems","height","gap","background","brown","width","borderRadius","border","overflow","boxShadow","borderColor","backgroundColor","white","cursor","color"],"mappings":"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","sourcesContent":["import Web3 from 'web3'\nimport React from \"react\"\nimport {COLORS} from \"./Colors\"\nimport SongCard from \"./SongCard\"\nimport Loader from \"react-loader-spinner\"\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome'\nimport { faHeadphones, faStore, faUser, faGift } from '@fortawesome/free-solid-svg-icons'\n\nclass Audience extends React.Component {\n\n    constructor(props){\n      super(props)\n      this.web3 = new Web3(Web3.givenProvider || \"http://localhost:7545\")\n      this.state = {name : \"\", audienceID: \"\", store : [], library: [], songsMapping: {}, supportArtistUsername:\"\", donation:\"\"}\n    }\n  \n    componentDidMount(){\n        this.loadStore().then(()=>{ console.log(\"Loaded Store\")\n            this.loadAudienceDetails().then(() => { console.log(\"Loaded Audience's Details\")\n                this.loadSongDetails().then(() => { console.log(\"Loaded Songs\")})})\n        })\n    }\n\n    async loadStore(){\n      const contractInstance = await this.props.contract.deployed()\n      const count = await contractInstance.getNumSongs({from:this.props.account})\n      let mapping = {}\n      for(let i=1;i<parseInt(count.toString())+1;i++){\n        mapping[i] = 0;\n      }\n      this.setState({songsMapping: mapping})\n    }\n\n    async loadAudienceDetails(){\n      const contractInstance = await this.props.contract.deployed()\n      const audienceDetails = await contractInstance.getAudienceDetails({from:this.props.account})\n      let mapping = this.state.songsMapping\n      for(let i=0;i<audienceDetails[2].length;i++){\n        mapping[parseInt(audienceDetails[2][i].toString())] = 1\n      }\n      this.setState({\n        name:audienceDetails[0].toString(),\n        audienceID:audienceDetails[1].toString(),\n        songsMapping:mapping\n      })\n    }\n\n    async loadSongDetails(){\n      const contractInstance = await this.props.contract.deployed()\n      let n = Object.keys(this.state.songsMapping).length\n      let newSongs = []\n      let purchasedSongs = []\n\n      for(let i=1;i<n+1;i++){\n        let songDetails = await contractInstance.getSongDetails(i, {from:this.props.account})\n        if(this.state.songsMapping[i]===1)\n        {\n          purchasedSongs.push({\n            'name': songDetails[0],\n            'artist' : songDetails[1],\n            'genre': songDetails[2],\n            'hash': songDetails[3],\n            'cost': songDetails[4].toString(),\n            'songID': i\n          });\n        }\n        else\n        {\n          newSongs.push({\n            'name': songDetails[0],\n            'artist' : songDetails[1],\n            'genre': songDetails[2],\n            'hash': songDetails[3],\n            'cost': songDetails[4].toString(),\n            'songID': i\n          });\n        }\n      } \n\n      this.setState({\n        library : purchasedSongs,\n        store : newSongs\n      })\n    }\n\n    onSubmitClick = async (event)=>{\n      event.preventDefault()\n      if(this.state.supportArtistUsername){\n          const contractInstance = await this.props.contract.deployed()\n          await contractInstance.donateArtist(this.state.supportArtistUsername, {from:this.props.account, value:this.web3.utils.toWei(this.state.donation, 'milliether')}).then(()=>{\n              window.location.reload()\n          })\n      }\n      console.log(\"Submitted\")\n    } \n\n\n    render(){\n      if (this.state.ID === \"\"){\n          return (\n              <div style = {styles.main}>\n                <Loader type = \"Bars\" color = {COLORS.black}/>\n              </div>\n          )\n      }\n\n    else{\n        return (\n            <div style = {styles.main}>\n                <div style = {styles.info}>\n                      <h2><FontAwesomeIcon icon={faHeadphones}/> {this.state.name}  </h2>\n                      <h3> Audience ID : {this.state.audienceID} </h3>\n                </div>\n                <div style = {styles.area}>\n                  <div style = {styles.library}>\n                    <h3 style = {{textAlign:\"center\"}}> <FontAwesomeIcon icon={faUser}/> Library </h3>\n                      {this.state.library.map((item,i)=> (\n                          <SongCard \n                          type = {\"audience\"}\n                          name = {item.name}\n                          artist = {item.artist}\n                          genre = {item.genre}\n                          hash = {item.hash}\n                          songID = {item.songID}\n                          key = {i}/>))}\n                  </div>\n                  <div style = {styles.store}>\n                    <h3 style = {{textAlign:\"center\"}}> <FontAwesomeIcon icon={faStore}/> Store </h3>\n                      {this.state.store.map((item,i)=> (\n                          <SongCard \n                          contract = {this.props.contract} ipfs = {this.props.ipfs} account = {this.props.account}\n                          type = {\"shop\"}\n                          name = {item.name}\n                          artist = {item.artist}\n                          genre = {item.genre}\n                          cost = {item.cost}\n                          hash = {item.hash}\n                          songID = {item.songID}\n                          key = {i}/>))}\n                  </div>\n                </div>\n                <div>\n                  <form>\n                    <div style = {styles.form}>\n                      <h3 style = {{textAlign:\"center\"}}> <FontAwesomeIcon icon={faGift}/> Sponsor Artist</h3>\n                      <input  type=\"text\" placeholder =\"Artist Username\"  style = {styles.textInput} \n                          value={this.state.supportArtistUsername} required\n                          onChange={(x)=>{this.setState({supportArtistUsername:x.target.value})}} />\n                      <input  type=\"text\" placeholder =\"Amount\"  style = {styles.textInput} \n                          value={this.state.donation} required\n                          onChange={(x)=>{this.setState({donation:x.target.value})}} />      \n                      <input type=\"submit\"  onClick={this.onSubmitClick} style = {styles.button} value=\"Donate\" />\n                    </div>\n                  </form>\n                </div>\n            </div>\n        )\n    }\n  }\n}\n  \nconst styles = {\n  main : {\n    padding : \"3%\",\n    display:\"flex\", \n    flexDirection:\"column\", \n    justifyContent: \"centre\", \n    alignItems: \"center\", \n    height:\"110vh\",\n    gap :\"5%\",\n    background:COLORS.brown,\n    },\n  info : {\n    display:\"flex\", \n    flexDirection:\"column\", \n    alignItems: \"center\", \n    },\n  library : {\n    height :\"100%\",\n    width :\"40%\",\n    padding :\"25px\",\n    display:\"flex\", \n    flexDirection:\"column\",\n    borderRadius:\"30px\",\n    border: \"3px solid\",\n    overflow: \"auto\",\n    gap :\"10px\",\n    boxShadow: \"2px 5px 2px #191919\",\n    borderColor :COLORS.black,\n    backgroundColor:COLORS.white,\n  },\n  store : {\n    height :\"100%\",\n    width :\"60%\",\n    padding :\"25px\",\n    display:\"flex\", \n    flexDirection:\"column\",\n    borderRadius:\"30px\",\n    border: \"3px solid\",\n    overflow: \"auto\",\n    gap :\"10px\",\n    boxShadow: \"2px 5px 2px #191919\",\n    borderColor :COLORS.black,\n    backgroundColor: COLORS.white,\n  },\n  area : {\n    height :\"100%\",\n    width :\"90%\",\n    display:\"flex\", \n    flexDirection:\"row\",\n    gap : \"5%\"\n  },\n  form:{\n    padding :\"2%\",\n    display:\"flex\", \n    flexDirection:\"row\",\n    alignItems: \"center\", \n    borderRadius:\"10px\",\n    border: \"2px solid\",\n    gap : \"3%\",\n    borderColor :COLORS.black,\n    backgroundColor:COLORS.brown,\n  },\n  textInput : {\n    width : \"50%\",\n    borderRadius:\"15px\",\n    padding: \"2%\",\n  },\n  button : {\n    padding : \"2%\",\n    borderRadius:\"15px\", \n    border:\"0px\", \n    cursor:\"pointer\",\n    background:COLORS.black, \n    color: COLORS.white,\n  },\n}\n  \nexport default Audience;"]},"metadata":{},"sourceType":"module"}