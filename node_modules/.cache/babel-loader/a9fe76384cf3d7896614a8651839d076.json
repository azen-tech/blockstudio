{"ast":null,"code":"var _jsxFileName = \"/home/azen/Documents/blockstudio-main/App/src/Components/Audience.js\";\nimport Web3 from 'web3';\nimport React from \"react\";\nimport { COLORS } from \"./Colors\";\nimport SongCard from \"./SongCard\";\nimport Loader from \"react-loader-spinner\";\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faHeadphones, faStore, faUser, faGift } from '@fortawesome/free-solid-svg-icons';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nclass Audience extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.onSubmitClick = async event => {\n      event.preventDefault();\n\n      if (this.state.supportArtistUsername) {\n        const contractInstance = await this.props.contract.deployed();\n        await contractInstance.donateArtist(this.state.supportArtistUsername, {\n          from: this.props.account,\n          value: this.web3.utils.toWei(this.state.donation, 'milliether')\n        }).then(() => {\n          window.location.reload();\n        });\n      }\n\n      console.log(\"Submitted\");\n    };\n\n    this.web3 = new Web3(Web3.givenProvider || \"http://localhost:7545\");\n    this.state = {\n      name: \"\",\n      audienceID: \"\",\n      store: [],\n      library: [],\n      songsMapping: {},\n      supportArtistUsername: \"\",\n      donation: \"\"\n    };\n  }\n\n  componentDidMount() {\n    this.loadStore().then(() => {\n      console.log(\"Loaded Store\");\n      this.loadAudienceDetails().then(() => {\n        console.log(\"Loaded Audience's Details\");\n        this.loadSongDetails().then(() => {\n          console.log(\"Loaded Songs\");\n        });\n      });\n    });\n  }\n\n  async loadStore() {\n    const contractInstance = await this.props.contract.deployed();\n    const count = await contractInstance.getNumSongs({\n      from: this.props.account\n    });\n    let mapping = {};\n\n    for (let i = 1; i < parseInt(count.toString()) + 1; i++) {\n      mapping[i] = 0;\n    }\n\n    this.setState({\n      songsMapping: mapping\n    });\n  }\n\n  async loadAudienceDetails() {\n    const contractInstance = await this.props.contract.deployed();\n    const audienceDetails = await contractInstance.getAudienceDetails({\n      from: this.props.account\n    });\n    let mapping = this.state.songsMapping;\n\n    for (let i = 0; i < audienceDetails[2].length; i++) {\n      mapping[parseInt(audienceDetails[2][i].toString())] = 1;\n    }\n\n    this.setState({\n      name: audienceDetails[0].toString(),\n      audienceID: audienceDetails[1].toString(),\n      songsMapping: mapping\n    });\n  }\n\n  async loadSongDetails() {\n    const contractInstance = await this.props.contract.deployed();\n    let n = Object.keys(this.state.songsMapping).length;\n    let newSongs = [];\n    let purchasedSongs = [];\n\n    for (let i = 1; i < n + 1; i++) {\n      let songDetails = await contractInstance.getSongDetails(i, {\n        from: this.props.account\n      });\n\n      if (this.state.songsMapping[i] === 1) {\n        purchasedSongs.push({\n          'name': songDetails[0],\n          'artist': songDetails[1],\n          'genre': songDetails[2],\n          'hash': songDetails[3],\n          'cost': songDetails[4].toString(),\n          'songID': i\n        });\n      } else {\n        newSongs.push({\n          'name': songDetails[0],\n          'artist': songDetails[1],\n          'genre': songDetails[2],\n          'hash': songDetails[3],\n          'cost': songDetails[4].toString(),\n          'songID': i\n        });\n      }\n    }\n\n    this.setState({\n      library: purchasedSongs,\n      store: newSongs\n    });\n  }\n\n  render() {\n    if (this.state.ID === \"\") {\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        style: styles.main,\n        children: /*#__PURE__*/_jsxDEV(Loader, {\n          type: \"Bars\",\n          color: COLORS.black\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 102,\n          columnNumber: 17\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 101,\n        columnNumber: 15\n      }, this);\n    } else {\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        style: styles.main,\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          style: styles.info,\n          children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n            children: [/*#__PURE__*/_jsxDEV(FontAwesomeIcon, {\n              icon: faHeadphones\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 111,\n              columnNumber: 27\n            }, this), \" \", this.state.name, \"  \"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 111,\n            columnNumber: 23\n          }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n            children: [\" Audience ID : \", this.state.audienceID, \" \"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 112,\n            columnNumber: 23\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 110,\n          columnNumber: 17\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: styles.area,\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            style: styles.library,\n            children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n              style: {\n                textAlign: \"center\"\n              },\n              children: [\" \", /*#__PURE__*/_jsxDEV(FontAwesomeIcon, {\n                icon: faUser\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 116,\n                columnNumber: 57\n              }, this), \" Library \"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 116,\n              columnNumber: 21\n            }, this), this.state.library.map((item, i) => /*#__PURE__*/_jsxDEV(SongCard, {\n              type: \"audience\",\n              name: item.name,\n              artist: item.artist,\n              genre: item.genre,\n              hash: item.hash,\n              songID: item.songID\n            }, i, false, {\n              fileName: _jsxFileName,\n              lineNumber: 118,\n              columnNumber: 27\n            }, this))]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 115,\n            columnNumber: 19\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            style: styles.store,\n            children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n              style: {\n                textAlign: \"center\"\n              },\n              children: [\" \", /*#__PURE__*/_jsxDEV(FontAwesomeIcon, {\n                icon: faStore\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 128,\n                columnNumber: 57\n              }, this), \" Store \"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 128,\n              columnNumber: 21\n            }, this), this.state.store.map((item, i) => /*#__PURE__*/_jsxDEV(SongCard, {\n              contract: this.props.contract,\n              ipfs: this.props.ipfs,\n              account: this.props.account,\n              type: \"shop\",\n              name: item.name,\n              artist: item.artist,\n              genre: item.genre,\n              cost: item.cost,\n              hash: item.hash,\n              songID: item.songID\n            }, i, false, {\n              fileName: _jsxFileName,\n              lineNumber: 130,\n              columnNumber: 27\n            }, this))]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 127,\n            columnNumber: 19\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 114,\n          columnNumber: 17\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: /*#__PURE__*/_jsxDEV(\"form\", {\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              style: styles.form,\n              children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n                style: {\n                  textAlign: \"center\"\n                },\n                children: [\" \", /*#__PURE__*/_jsxDEV(FontAwesomeIcon, {\n                  icon: faGift\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 145,\n                  columnNumber: 59\n                }, this), \" Sponsor Artist\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 145,\n                columnNumber: 23\n              }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                type: \"text\",\n                placeholder: \"Artist Username\",\n                style: styles.textInput,\n                value: this.state.supportArtistUsername,\n                required: true,\n                onChange: x => {\n                  this.setState({\n                    supportArtistUsername: x.target.value\n                  });\n                }\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 146,\n                columnNumber: 23\n              }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                type: \"text\",\n                placeholder: \"Amount\",\n                style: styles.textInput,\n                value: this.state.donation,\n                required: true,\n                onChange: x => {\n                  this.setState({\n                    donation: x.target.value\n                  });\n                }\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 149,\n                columnNumber: 23\n              }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                type: \"submit\",\n                onClick: this.onSubmitClick,\n                style: styles.button,\n                value: \"Donate\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 152,\n                columnNumber: 23\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 144,\n              columnNumber: 21\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 143,\n            columnNumber: 19\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 142,\n          columnNumber: 17\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 109,\n        columnNumber: 13\n      }, this);\n    }\n  }\n\n}\n\nconst styles = {\n  main: {\n    padding: \"3%\",\n    display: \"flex\",\n    flexDirection: \"column\",\n    justifyContent: \"centre\",\n    alignItems: \"center\",\n    height: \"110vh\",\n    gap: \"5%\",\n    background: COLORS.brown\n  },\n  info: {\n    display: \"flex\",\n    flexDirection: \"column\",\n    alignItems: \"center\"\n  },\n  library: {\n    height: \"100%\",\n    width: \"40%\",\n    padding: \"25px\",\n    display: \"flex\",\n    flexDirection: \"column\",\n    borderRadius: \"30px\",\n    border: \"3px solid\",\n    overflow: \"auto\",\n    gap: \"10px\",\n    boxShadow: \"2px 5px 2px #191919\",\n    borderColor: COLORS.black,\n    backgroundColor: COLORS.white\n  },\n  store: {\n    height: \"100%\",\n    width: \"60%\",\n    padding: \"25px\",\n    display: \"flex\",\n    flexDirection: \"column\",\n    borderRadius: \"30px\",\n    border: \"3px solid\",\n    overflow: \"auto\",\n    gap: \"10px\",\n    boxShadow: \"2px 5px 2px #191919\",\n    borderColor: COLORS.black,\n    backgroundColor: COLORS.white\n  },\n  area: {\n    height: \"100%\",\n    width: \"90%\",\n    display: \"flex\",\n    flexDirection: \"row\",\n    gap: \"5%\"\n  },\n  form: {\n    padding: \"2%\",\n    display: \"flex\",\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    borderRadius: \"10px\",\n    border: \"2px solid\",\n    gap: \"3%\",\n    borderColor: COLORS.black,\n    backgroundColor: COLORS.brown\n  },\n  textInput: {\n    width: \"50%\",\n    borderRadius: \"15px\",\n    padding: \"2%\"\n  },\n  button: {\n    padding: \"2%\",\n    borderRadius: \"15px\",\n    border: \"0px\",\n    cursor: \"pointer\",\n    background: COLORS.black,\n    color: COLORS.white\n  }\n};\nexport default Audience;","map":{"version":3,"sources":["/home/azen/Documents/blockstudio-main/App/src/Components/Audience.js"],"names":["Web3","React","COLORS","SongCard","Loader","FontAwesomeIcon","faHeadphones","faStore","faUser","faGift","Audience","Component","constructor","props","onSubmitClick","event","preventDefault","state","supportArtistUsername","contractInstance","contract","deployed","donateArtist","from","account","value","web3","utils","toWei","donation","then","window","location","reload","console","log","givenProvider","name","audienceID","store","library","songsMapping","componentDidMount","loadStore","loadAudienceDetails","loadSongDetails","count","getNumSongs","mapping","i","parseInt","toString","setState","audienceDetails","getAudienceDetails","length","n","Object","keys","newSongs","purchasedSongs","songDetails","getSongDetails","push","render","ID","styles","main","black","info","area","textAlign","map","item","artist","genre","hash","songID","ipfs","cost","form","textInput","x","target","button","padding","display","flexDirection","justifyContent","alignItems","height","gap","background","brown","width","borderRadius","border","overflow","boxShadow","borderColor","backgroundColor","white","cursor","color"],"mappings":"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","sourcesContent":["import Web3 from 'web3'\nimport React from \"react\"\nimport {COLORS} from \"./Colors\"\nimport SongCard from \"./SongCard\"\nimport Loader from \"react-loader-spinner\"\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome'\nimport { faHeadphones, faStore, faUser, faGift } from '@fortawesome/free-solid-svg-icons'\n\nclass Audience extends React.Component {\n\n    constructor(props){\n      super(props)\n      this.web3 = new Web3(Web3.givenProvider || \"http://localhost:7545\")\n      this.state = {name : \"\", audienceID: \"\", store : [], library: [], songsMapping: {}, supportArtistUsername:\"\", donation:\"\"}\n    }\n  \n    componentDidMount(){\n        this.loadStore().then(()=>{ console.log(\"Loaded Store\")\n            this.loadAudienceDetails().then(() => { console.log(\"Loaded Audience's Details\")\n                this.loadSongDetails().then(() => { console.log(\"Loaded Songs\")})})\n        })\n    }\n\n    async loadStore(){\n      const contractInstance = await this.props.contract.deployed()\n      const count = await contractInstance.getNumSongs({from:this.props.account})\n      let mapping = {}\n      for(let i=1;i<parseInt(count.toString())+1;i++){\n        mapping[i] = 0;\n      }\n      this.setState({songsMapping: mapping})\n    }\n\n    async loadAudienceDetails(){\n      const contractInstance = await this.props.contract.deployed()\n      const audienceDetails = await contractInstance.getAudienceDetails({from:this.props.account})\n      let mapping = this.state.songsMapping\n      for(let i=0;i<audienceDetails[2].length;i++){\n        mapping[parseInt(audienceDetails[2][i].toString())] = 1\n      }\n      this.setState({\n        name:audienceDetails[0].toString(),\n        audienceID:audienceDetails[1].toString(),\n        songsMapping:mapping\n      })\n    }\n\n    async loadSongDetails(){\n      const contractInstance = await this.props.contract.deployed()\n      let n = Object.keys(this.state.songsMapping).length\n      let newSongs = []\n      let purchasedSongs = []\n\n      for(let i=1;i<n+1;i++){\n        let songDetails = await contractInstance.getSongDetails(i, {from:this.props.account})\n        if(this.state.songsMapping[i]===1)\n        {\n          purchasedSongs.push({\n            'name': songDetails[0],\n            'artist' : songDetails[1],\n            'genre': songDetails[2],\n            'hash': songDetails[3],\n            'cost': songDetails[4].toString(),\n            'songID': i\n          });\n        }\n        else\n        {\n          newSongs.push({\n            'name': songDetails[0],\n            'artist' : songDetails[1],\n            'genre': songDetails[2],\n            'hash': songDetails[3],\n            'cost': songDetails[4].toString(),\n            'songID': i\n          });\n        }\n      } \n\n      this.setState({\n        library : purchasedSongs,\n        store : newSongs\n      })\n    }\n\n    onSubmitClick = async (event)=>{\n      event.preventDefault()\n      if(this.state.supportArtistUsername){\n          const contractInstance = await this.props.contract.deployed()\n          await contractInstance.donateArtist(this.state.supportArtistUsername, {from:this.props.account, value:this.web3.utils.toWei(this.state.donation, 'milliether')}).then(()=>{\n              window.location.reload()\n          })\n      }\n      console.log(\"Submitted\")\n    } \n\n\n    render(){\n      if (this.state.ID === \"\"){\n          return (\n              <div style = {styles.main}>\n                <Loader type = \"Bars\" color = {COLORS.black}/>\n              </div>\n          )\n      }\n\n    else{\n        return (\n            <div style = {styles.main}>\n                <div style = {styles.info}>\n                      <h2><FontAwesomeIcon icon={faHeadphones}/> {this.state.name}  </h2>\n                      <h3> Audience ID : {this.state.audienceID} </h3>\n                </div>\n                <div style = {styles.area}>\n                  <div style = {styles.library}>\n                    <h3 style = {{textAlign:\"center\"}}> <FontAwesomeIcon icon={faUser}/> Library </h3>\n                      {this.state.library.map((item,i)=> (\n                          <SongCard \n                          type = {\"audience\"}\n                          name = {item.name}\n                          artist = {item.artist}\n                          genre = {item.genre}\n                          hash = {item.hash}\n                          songID = {item.songID}\n                          key = {i}/>))}\n                  </div>\n                  <div style = {styles.store}>\n                    <h3 style = {{textAlign:\"center\"}}> <FontAwesomeIcon icon={faStore}/> Store </h3>\n                      {this.state.store.map((item,i)=> (\n                          <SongCard \n                          contract = {this.props.contract} ipfs = {this.props.ipfs} account = {this.props.account}\n                          type = {\"shop\"}\n                          name = {item.name}\n                          artist = {item.artist}\n                          genre = {item.genre}\n                          cost = {item.cost}\n                          hash = {item.hash}\n                          songID = {item.songID}\n                          key = {i}/>))}\n                  </div>\n                </div>\n                <div>\n                  <form>\n                    <div style = {styles.form}>\n                      <h3 style = {{textAlign:\"center\"}}> <FontAwesomeIcon icon={faGift}/> Sponsor Artist</h3>\n                      <input  type=\"text\" placeholder =\"Artist Username\"  style = {styles.textInput} \n                          value={this.state.supportArtistUsername} required\n                          onChange={(x)=>{this.setState({supportArtistUsername:x.target.value})}} />\n                      <input  type=\"text\" placeholder =\"Amount\"  style = {styles.textInput} \n                          value={this.state.donation} required\n                          onChange={(x)=>{this.setState({donation:x.target.value})}} />      \n                      <input type=\"submit\"  onClick={this.onSubmitClick} style = {styles.button} value=\"Donate\" />\n                    </div>\n                  </form>\n                </div>\n            </div>\n        )\n    }\n  }\n}\n  \nconst styles = {\n  main : {\n    padding : \"3%\",\n    display:\"flex\", \n    flexDirection:\"column\", \n    justifyContent: \"centre\", \n    alignItems: \"center\", \n    height:\"110vh\",\n    gap :\"5%\",\n    background:COLORS.brown,\n    },\n  info : {\n    display:\"flex\", \n    flexDirection:\"column\", \n    alignItems: \"center\", \n    },\n  library : {\n    height :\"100%\",\n    width :\"40%\",\n    padding :\"25px\",\n    display:\"flex\", \n    flexDirection:\"column\",\n    borderRadius:\"30px\",\n    border: \"3px solid\",\n    overflow: \"auto\",\n    gap :\"10px\",\n    boxShadow: \"2px 5px 2px #191919\",\n    borderColor :COLORS.black,\n    backgroundColor:COLORS.white,\n  },\n  store : {\n    height :\"100%\",\n    width :\"60%\",\n    padding :\"25px\",\n    display:\"flex\", \n    flexDirection:\"column\",\n    borderRadius:\"30px\",\n    border: \"3px solid\",\n    overflow: \"auto\",\n    gap :\"10px\",\n    boxShadow: \"2px 5px 2px #191919\",\n    borderColor :COLORS.black,\n    backgroundColor: COLORS.white,\n  },\n  area : {\n    height :\"100%\",\n    width :\"90%\",\n    display:\"flex\", \n    flexDirection:\"row\",\n    gap : \"5%\"\n  },\n  form:{\n    padding :\"2%\",\n    display:\"flex\", \n    flexDirection:\"row\",\n    alignItems: \"center\", \n    borderRadius:\"10px\",\n    border: \"2px solid\",\n    gap : \"3%\",\n    borderColor :COLORS.black,\n    backgroundColor:COLORS.brown,\n  },\n  textInput : {\n    width : \"50%\",\n    borderRadius:\"15px\",\n    padding: \"2%\",\n  },\n  button : {\n    padding : \"2%\",\n    borderRadius:\"15px\", \n    border:\"0px\", \n    cursor:\"pointer\",\n    background:COLORS.black, \n    color: COLORS.white,\n  },\n}\n  \nexport default Audience;"]},"metadata":{},"sourceType":"module"}